# Визуализатор графа зависимостей Cargo

## 1. Общее описание

CLI-инструмент для анализа зависимостей пакетов Rust из реестра crates.io и визуализации их в виде текстового графа.
На третьем этапе программа по имени пакета и ссылке на crates.io строит полный граф зависимостей, а также может работать в тестовом режиме с локальным файлом, описывающим граф.

---

## 2. Описание функций и настроек

Программа настраивается через следующие опции командной строки:

-   `--package <ИМЯ>`: **(Обязательный)** Имя анализируемого пакета.
-   `--repo-url <URL>`: **(Обязательный)** URL-адрес пакета на crates.io или путь к файлу в test-mode.
-   `--test-mode`: Режим работы с локальным тестовым файлом графа зависимостей.
-   `--ascii-tree`: Флаг, который на будущих этапах будет включать вывод графа в виде ASCII-дерева.
-   `--filter <ПОДСТРОКА>`: Подстрока для фильтрации пакетов.
-   `-h`, `--help`: Показывает справочное сообщение со всеми доступными параметрами.

В тестовом режиме можно использовать текстовый файл для описания графа зависимостей. Формат файла:

- Каждая непустая строка описывает один пакет и его прямые зависимости.
- Синтаксис строки: `ПАКЕТ: ЗАВИСИМОСТЬ1 ЗАВИСИМОСТЬ2 ...`.
- Имена пакетов и зависимостей задаются без пробелов.
- Зависимости разделяются пробелами.
- Пустые строки и строки, начинающиеся с `#`, игнорируются.

---

## 3. Команды для сборки и запуска

Проект написан на Python и не требует предварительной сборки. Для запуска используется интерпретатор Python.

### Основная команда для запуска:
```
python main.py [ПАРАМЕТРЫ]
```

---

## 4. Примеры использования

### Основной сценарий (анализ пакета с crates.io)

Анализ пакета `serde` по ссылке из crates.io.

Команда:
```
python main.py --package serde --repo-url https://crates.io/crates/serde
```

Результат:
```
Граф зависимостей для пакета 'serde':
proc-macro2: unicode-ident
quote: proc-macro2
serde: serde_core, serde_derive
serde_core: serde_derive
serde_derive: proc-macro2, quote, syn
syn: proc-macro2, quote, unicode-ident
unicode-ident: (нет зависимостей)
```

### Тестовый граф с циклами и фильтрацией

Демонстрация обработки циклических зависимостей и фильтрации пакетов. Файл `graph.txt`:
```
A: B C X
B: D E
C: E
D: F
E: B F
```

Команда:
```
python main.py --package A --repo-url graph.txt --test-mode --filter X
```

Результат:
```
Граф зависимостей для пакета 'A':
(из графа исключены все пакеты, имя которых содержит подстроку 'X')
A: B, C
B: D, E
C: E
D: F
E: B, F
F: (нет зависимостей)
Обнаружены циклические зависимости:
B <-> E
```
### Обработка ошибок

Пример вызова с неправильным URL (не crates.io):

Команда:
```
python main.py --package serde --repo-url https://github.com/serde-rs/serde
```

Результат:
```
Ошибки валидации:
  - Ссылка должна быть вида https://crates.io/crates/<имя_пакета>
```

Пример вызова с несовпадением имени пакета и имени в URL:

Команда:
```
python main.py --package serde --repo-url https://crates.io/crates/serde_json
```

Результат:
```
Ошибки валидации:
  - Имя пакета в URL (serde_json) не совпадает с --package (serde)
```

Пример вызова для несуществующего пакета на crates.io

Команда:
```
python main.py --package non-existent-package --repo-url https://crates.io/crates/non-existent-package
```

Результат:
```
Не удалось получить информацию о крейте non-existent-package: HTTP Error 404: Not Found
```